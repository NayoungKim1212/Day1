<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>Job Korea</title>

<jsp:include page="/WEB-INF/view/common/common_include.jsp"></jsp:include>

<!-- D3 -->
<style>
//
click-able rows
	.clickable-rows {tbody tr td { cursor:pointer;
	
}

.el-table__expanded-cell {
	cursor: default;
}
}
</style>
<script type="text/javascript">
        var pageSizeinf  = 3;
        var pageBlockSizeinquiry  = 10;

		/* onload 이벤트  */
		$(function(){
			
			selectComCombo("dept", "deptall", "all", "");   // 조회 종류   부서 : dept  acc : 회계계정  cli:거래처  pro:싱품 whp: 창고담당자  wh: 창고, Combo Name, Option("all" : 전체     "sel" : 선택 , NULL)  
			selectComCombo("acc", "accall", "all","A100");   // 조회 종류   부서 : dept  acc : 회계계정 cli 거래처  pro:싱품 whp: 창고담당자 wh: 창고, Combo Name, Option("all" : 전체     "sel" : 선택 , 회계 계정 대분류 코드)  
			selectComCombo("cli", "clientall", "all", "");   // 조회 종류   부서 : dept  acc : 회계계정 cli 거래처  pro:싱품 whp: 창고담당자  wh: 창고, Combo Name, Option("all" : 전체     "sel" : 선택 , NULL)  
			selectComCombo("pro", "producttall", "all", "");   // 조회 종류   부서 : dept  acc : 회계계정 cli 거래처  pro:싱품 whp: 창고담당자  wh: 창고, Combo Name, Option("all" : 전체     "sel" : 선택 , NULL)  
			
			productCombo("l", "plall", "all", "","");   // 조회 종류   l : 대분류  m : 중분류  p:중분류 제품,   Combo Name, Option("all" : 전체     "sel" : 선택 ,  중분류 코드(제품 목록 조회시 필수))  
			
			
			// 공지사항 조회
			//fListInf();
			
			//간이차트 조회
			//goChart();
			
			// 버튼 이벤트 등록
			//fRegisterButtonClickEvent();
		});
		

		//차트 뿌리러 감
		function goChart(loginID) {
			//alert("1");
			//alert(JSON.stringify(data));
			var param= {
					loginID : loginID
			
			}
		
			var resultCallback1 = function(data) {
		//	 alert("3");
		//	alert(JSON.stringify(data.lec_Name_List));
		//	alert(JSON.stringify(data.lec_Name_List)) 
			
			fChart (data);
		};
		
		alert("2");
		callAjax("/dashboard/goChart.do", "post", "json", true, param, resultCallback1);
	}
		
		
		// bar형 chart
		function fChart(data){
		
			//일단 간단한 값만
			var cntEngineer = data.cntEngineer;
			var cntCompany = data.cntCompany;
			var cntProject = data.cntProject;
			//var cntApplicant = ${cntApplicant};
			
			var minChart = new Chart($("#minChart"),{
				
				type : 'bar' ,
				data : {
					labels : ['가입된 엔지니어 수', '가입된 기업 수', '등록된 프로젝트 수', '일별 지원자 수'] ,
						datasets : [{
								label : '간이 통계' ,
								data : [cntEngineer, cntCompany, cntProject] ,
								borderColor: [
												'rgba(255, 99, 132, 1)' ,
												'rgba(255, 206, 86, 0.2)',
												'rgba(54, 162, 235, 0.2)'
											] ,
								borderWidth : 1
						}]
				}
			});
		}
		
		
		
		/** 버튼 이벤트 등록 */
		function fRegisterButtonClickEvent() {
			$('a[name=btnInfo]').click(function(e) {
				e.preventDefault();

				var btnId = $(this).attr('id');
				switch (btnId) {
					case 'btnCloseGrpCod' :
					case 'btnCloseDtlCod' :
					gfCloseModal();
					break;
			}
		});
	}
				  
				
		/** 공지사항 조회 */
		function fListInf(currentPage) {
			
			currentPage = currentPage || 1;
			
			console.log("currentPage : " + currentPage);
			
			var param = {
						currentPage : currentPage
					,	pageSize : pageSizeinf
			}
			
			var resultCallback = function(data) {
				fListInfResult(data, currentPage);
			};
			
			//Ajax실행 방식
			//callAjax("Url",type,return,async or sync방식,넘겨준거,값,Callback함수 이름)
			//html로 받을거라 text
			callAjax("/inf/listinf.do", "post", "text", true, param, resultCallback);
		}
		
		
		/** 공지사항 조회 콜백 함수 */
		function fListInfResult(data, currentPage) {
					//alert(data);
			console.log(data);		
			
			// 기존 목록 삭제
			$('#listInf').empty();
			$("#listInf").append(data);
			
			// 총 개수 추출
			var totalCntlistInf = $("#totcnt").val();
			var list = $("#selectedInfNo").val();
			// 페이지 네비게이션 생성
			var paginationHtml = getPaginationHtml(currentPage, totalCntlistInf, pageSizeinf, pageBlockSizeinquiry, 'fListInf',[list]);
			console.log("paginationHtml : " + paginationHtml);
		
			$("#listInfPagination").empty().append( paginationHtml );
		
		}
		
		 /*공지사항 상세 조회*/
		 function fNoticeModal(noticeNo) {
		
			 var param = {noticeNo : noticeNo};
			 var resultCallback2 = function(data){
				 fdetailResult(data);
			 };
			 
			 callAjax("/system/detailNotice.do", "post", "json", true, param, resultCallback2);
		 }
		
		 /*  공지사항 상세 조회 -> 콜백함수   */
		 function fdetailResult(data){

			 if(data.resultMsg == "SUCCESS"){
				 //모달 띄우기 
				 gfModalPop("#notice");
				 
				// 모달에 정보 넣기 
				frealPopModal(data.result);
			 
			 }else{
				 alert(data.resultMsg);
			 }
		 }
		
		 /* 팝업 _ 초기화 페이지(신규) 혹은 내용뿌리기  */
		 function frealPopModal(object){
			 
			 $("#loginId").val(object.loginId);
			 $("#loginId").attr("readonly", true); // 작성자 수정불가 
			 
			 $("#write_date").val(object.noticeRegdate);
			 $("#write_date").attr("readonly", true); // 처음 작성된 날짜 수정불가 
			 
			 $("#noticeTitle").val(object.noticeTitle);
			 $("#noticeTitle").attr("readonly", true);

			 $("#noticeContent").val(object.noticeContent);
			 $("#noticeContent").attr("readonly", true);
			 
			 $("#noticeNo").val(object.noticeNo); // 중요한 num 값도 숨겨서 받아온다. 
			 
		 }


		 function selectmidcat(){
			var largecd = $("#plall").val();
			productCombo("m", "pmall", "all", largecd,"");   // 조회 종류   l : 대분류  m : 중분류  p:중분류 제품,   Combo Name, Option("all" : 전체     "sel" : 선택 ,  중분류 코드(제품 목록 조회시 필수))  

			$("#pmall").find("option").remove();
			$("#divproducttall").find("option").remove();
		 }
		 
		 function selectproductlistcombo(){
			 var largecd = $("#plall").val();
			var margecd = $("#pmall").val();
			productCombo("p", "divproducttall", "all", largecd, margecd);   // 조회 종류   l : 대분류  m : 중분류  p:중분류 제품,   Combo Name, Option("all" : 전체     "sel" : 선택 ,  중분류 코드(제품 목록 조회시 필수))  
	    }

</script>

</head>
<body>
<form id="myForm" action=""  method="">

<input type="hidden" id="currentPage" value="1">
<input type="hidden" id="selectedInfNo" value="">
	<!-- 모달 배경 -->
	<div id="mask"></div>

	<div id="wrap_area">

		<h2 class="hidden">컨텐츠 영역</h2>
		<div id="container">
			<ul>
				<li class="lnb">
					<!-- lnb 영역 --> <jsp:include
						page="/WEB-INF/view/common/lnbMenu.jsp"></jsp:include> <!--// lnb 영역 -->
				</li>
				<li class="contents">
					<!-- contents -->
					<h3 class="hidden">contents 영역</h3> <!-- content -->
	               
					<div class="content" style="margin-bottom:20px;">
                       
						<p class="Location">
							<a href="../dashboard/dashboard.do" class="btn_set home">메인으로</a> <span
								class="btn_nav bold">메인</span> <a href="../dashboard/dashboard.do"
								class="btn_set refresh">새로고침</a>
						</p>

						<p class="conTitle" style="margin-bottom: 1%;">
							<span>공지 사항</span> <span class="fr"> 
								<span>로그인</span>
								<span>회원가입</span>
								<span>마이페이지</span>
								<!-- 
								<c:if test="${sessionScope.userType eq null}">
									<span>로그인</span>
									<span>일반 회원가입</span>
									<span>기업 회원가입</span>
								</c:if>
								<c:if test="${sessionScope.userType eq 'A'}">
									<span>로그아웃</span>
								</c:if>
								<c:if test="${sessionScope.userType eq 'B'} or ${sessionScope.userType eq 'C'}">
									<span>로그아웃</span>
									<span>마이페이지</span>
								</c:if>
								 -->
							</span>
						</p>
						
					   <!-- 프로젝트 조회 -->
						<div class="selectProject" >
							<table width="100%" cellpadding="5" cellspacing="0" border="1"
		                        align="left" 
		                        style="border-collapse: collapse; border: 10px #50bcdf; ">
		                        <tr style="border: 10px; border-color: blue">
		                               <td width="20" height="25" style="font-size: 120%">&nbsp;&nbsp;</td>
		                               <td width="220" height="25" style="font-size: 150%; font-weight: bold;">프로젝트 조회</td>
			                           <td width="40" height="25" style="font-size: 100%">상품 대분류&nbsp;</td><td><select id="plall" name="plall" onChange="javascript:selectmidcat();"></select></td>          
			                           <td width="30" height="25" style="font-size: 100%">상품 중분류&nbsp;</td><td><select id="pmall" name="pmall" onChange="javascript:selectproductlistcombo();"></select></td>  
			                           <td width="30" height="25" style="font-size: 100%">상품 &nbsp;</td><td><select id="divproducttall" name="divproducttall"></select></td>   
		                               <td width="100" height="25" style="font-size: 100%">부서&nbsp;</td><td><select id="deptall" name="deptall"></select></td>       
		                               <td width="100" height="25" style="font-size: 100%">계정코드&nbsp;</td><td><select id="accall" name="accall"></select></td>          
			                           <td width="120" height="25" style="font-size: 100%">세부계정코드&nbsp;</td><td><select id="accdetall" name="accdetall"></select></td>        
			                    </tr>
		                        <tr style="border: 10px; border-color: blue">
		                           <td width="20" height="25" style="font-size: 120%">&nbsp;&nbsp;</td>
		                           <td width="20" height="25" style="font-size: 120%">&nbsp;&nbsp;</td>
		                           <td width="40" height="25" style="font-size: 100%">&nbsp;</td><td></td>          
			                       <td width="30" height="25" style="font-size: 100%">거래처코드&nbsp;</td><td><select id="clientall" name="clientall">	</select></td>   
			                       <td width="30" height="25" style="font-size: 100%">상품코드&nbsp;</td><td><select id="producttall" name="producttall"></select></td>   
		                           <td width="100" height="25" style="font-size: 120%">&nbsp;&nbsp;</td>        
		                           <td width="100" height="60" style="font-size: 120%">
		                           <a href="" class="btnType blue" id="searchBtn" name="btn"><span>검  색</span></a></td> 
		                           <td width="120" height="25" style="font-size: 120%">&nbsp;&nbsp;</td>        
		                        </tr>
		                     </table>    
						</div>
						
				        <div class="divComGrpCodList">
								<table class="col">
									<caption>caption</caption>
									<colgroup>
									   <col width="5%">
										<col width="70%">
										<col width="10%">
										<col width="5%">
									</colgroup>
				
									<thead>
										<tr>
										    <th scope="col">번호</th>
											<th scope="col">제목</th>
											<th scope="col">작성일</th>
											<th scope="col">작성자</th>
										</tr>
									</thead>
									<tbody id="listInf">
									</tbody>
								</table>
					   </div>
										   
					   <div class="paging_area"  id="listInfPagination"> </div>
					   
					   <br><br>
					   
				
						
					</div> <!--// content -->

					</li>
			</ul>
		</div>
	</div>
					

				
				
</form>
</body>
</html>